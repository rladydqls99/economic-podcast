# PRD: 한국 경제 자동 팟캐스트 쇼츠 생성 시스템

**문서 버전:** 1.0
**작성일:** 2025-12-17
**프로젝트명:** Economic Podcast Shorts Generator
**문서 상태:** Draft

---

## 목차

1. [문서 개요](#1-문서-개요)
2. [제품 비전 및 목표](#2-제품-비전-및-목표)
3. [제품 범위](#3-제품-범위)
4. [사용자 시나리오](#4-사용자-시나리오)
5. [기능 요구사항](#5-기능-요구사항)
6. [기술 요구사항](#6-기술-요구사항)
7. [시스템 아키텍처](#7-시스템-아키텍처)
8. [데이터 플로우](#8-데이터-플로우)
9. [비기능 요구사항](#9-비기능-요구사항)
10. [제약사항 및 가정](#10-제약사항-및-가정)
11. [성공 지표](#11-성공-지표)
12. [일정 및 마일스톤](#12-일정-및-마일스톤)
13. [향후 확장 계획](#13-향후-확장-계획)
14. [부록](#14-부록)

---

## 1. 문서 개요

### 1.1. 문서 목적

본 문서는 매일 자동으로 한국 경제 이슈를 요약한 1분짜리 팟캐스트 쇼츠를 생성하고 YouTube에 업로드하는 시스템의 제품 요구사항을 정의합니다.

### 1.2. 용어 정의

| 용어           | 정의                                          |
| -------------- | --------------------------------------------- |
| 쇼츠 (Shorts)  | YouTube의 세로형 짧은 동영상 형식 (최대 60초) |
| HeyGen         | AI 기반 영상 생성 플랫폼                      |
| LLM            | Large Language Model (대규모 언어 모델)       |
| 이슈           | 반복적으로 언급되는 경제 뉴스 주제            |
| 대본           | 팟캐스트에서 읽을 스크립트                    |
| 폴링 (Polling) | 주기적으로 상태를 확인하는 방식               |

---

## 2. 제품 비전 및 목표

### 2.1. 제품 비전

**"매일 22시, 오늘의 한국 경제를 1분 안에 이해할 수 있는 자동화된 팟캐스트 쇼츠 플랫폼"**

### 2.2. 비즈니스 목표

- **자동화:** 운영자의 수동 개입 없이 매일 자동으로 콘텐츠 생성 및 업로드
- **일관성:** 고정된 캐릭터와 배경을 통한 브랜드 아이덴티티 확립
- **적시성:** 당일 22시까지의 경제 뉴스를 당일 밤에 제공
- **접근성:** 1분 내 짧은 포맷으로 바쁜 사용자도 쉽게 소비 가능

### 2.3. 제품 목표

1. 매일 22:00에 자동으로 한국 경제 뉴스 분석 및 영상 생성
2. 1분 분량의 고품질 팟캐스트 쇼츠 제작
3. YouTube Shorts 형식으로 자동 업로드
4. 최소 95% 이상의 자동화 성공률 달성

---

## 3. 제품 범위

### 3.1. 포함 범위 (In-Scope)

- 한국 경제 뉴스 자동 수집
- AI 기반 이슈 추출 및 중요도 분석
- 1분 분량 팟캐스트 대본 자동 생성
- HeyGen을 통한 영상 자동 제작
- YouTube Shorts 자동 업로드
- 매일 22:00 자동 실행 스케줄링
- 로그 및 에러 모니터링

### 3.2. 제외 범위 (Out-of-Scope)

- 미국 경제 뉴스 (Phase 2에서 고려)
- 다국어 지원 (Phase 2에서 고려)
- 사용자 커스터마이징 기능
- 실시간 뉴스 알림
- 모바일 앱 개발
- 댓글 관리 자동화

---

## 4. 사용자 시나리오

### 4.1. 주요 시나리오: 일일 자동 콘텐츠 생성

**사용자:** 시스템 스케줄러
**목표:** 매일 22시에 당일 경제 뉴스를 요약한 쇼츠 영상을 자동으로 생성하고 업로드

**전제 조건:**

- Express 서버가 정상 실행 중
- 모든 외부 API 키가 유효함
- YouTube OAuth 토큰이 갱신 가능한 상태

**주요 흐름:**

1. 매일 22:00, node-cron이 자동 작업을 트리거
2. 시스템이 오늘(0시~22시) 한국 경제 뉴스를 수집
3. LLM이 수집된 뉴스에서 2~4개 핵심 이슈를 추출
4. LLM이 1분 분량 팟캐스트 대본을 생성
5. HeyGen이 고정 캐릭터/배경으로 영상 제작
6. 시스템이 영상 생성 완료를 폴링으로 확인
7. YouTube Data API를 통해 Shorts로 업로드
8. 업로드 결과를 로그 파일에 기록

**후속 조건:**

- 새로운 YouTube Shorts 영상이 채널에 게시됨
- 로그 파일에 성공 기록이 저장됨

**예외 흐름:**

- **뉴스 수집 실패:** 재시도 3회, 실패 시 관리자에게 알림 전송
- **LLM API 실패:** 백업 프롬프트로 재시도
- **HeyGen 생성 실패:** 에러 로그 기록 및 알림
- **YouTube 업로드 실패:** OAuth 토큰 갱신 시도, 실패 시 알림

### 4.2. 보조 시나리오: 운영자 모니터링

**사용자:** 콘텐츠 운영자
**목표:** 자동 생성된 콘텐츠의 품질과 시스템 상태 확인

**주요 흐름:**

1. 운영자가 매일 아침 로그 파일 확인
2. 전날 생성된 영상의 YouTube 링크 확인
3. 대본 품질 및 이슈 선정의 적절성 평가
4. 필요 시 수동으로 영상 수정 또는 재업로드

---

## 5. 기능 요구사항

### 5.1. FR-001: 뉴스 수집 모듈

**우선순위:** P0 (필수)

**설명:** 한국 경제 관련 뉴스를 다양한 소스에서 자동으로 수집합니다.

**상세 요구사항:**

- FR-001-01: 시스템은 22:00 실행 시 당일 0시~22시 사이의 뉴스를 수집해야 함
- FR-001-02: 최소 3개 이상의 뉴스 소스를 지원해야 함
  - 언론사 경제 섹션 RSS 피드
  - Google News 한국 경제 키워드 검색
  - 주요 경제 언론사 웹 크롤링
- FR-001-03: 각 뉴스 항목은 다음 정보를 포함해야 함
  - 제목 (필수)
  - 요약/리드 (필수)
  - 원문 링크 (필수)
  - 발행 시간 (필수)
  - 언론사명 (필수)
  - 카테고리 (선택)
- FR-001-04: 수집된 뉴스는 발행 시간 기준으로 필터링되어야 함
- FR-001-05: 중복 제목 또는 유사도 90% 이상 기사는 자동 제거되어야 함

**Acceptance Criteria:**

```
Given 22:00에 스케줄러가 실행되었을 때
When 뉴스 수집 모듈이 실행되면
Then 최소 20개 이상의 유효한 경제 뉴스가 수집되어야 함
And 모든 뉴스 항목은 필수 필드를 포함해야 함
And 중복 기사는 제거되어야 함
And 수집 완료 로그가 기록되어야 함
```

**기술적 의존성:**

- RSS 파서 라이브러리
- 웹 크롤링 라이브러리 (Puppeteer 또는 Cheerio)
- 날짜/시간 처리 라이브러리

---

### 5.2. FR-002: 이슈 추출 및 선정 모듈

**우선순위:** P0 (필수)

**설명:** 수집된 뉴스에서 핵심 이슈를 추출하고 중요도 순으로 선정합니다.

**상세 요구사항:**

- FR-002-01: 수집된 뉴스에서 반복적으로 언급되는 키워드를 추출해야 함
- FR-002-02: OpenAI API를 사용하여 2~4개의 핵심 이슈를 선정해야 함
- FR-002-03: 각 이슈는 다음 정보를 포함해야 함
  - 이슈 제목
  - 이슈 요약 (2-3문장)
  - 중요도 점수 (1-100)
  - 관련 키워드 목록
- FR-002-04: 광고성 또는 연예 관련 콘텐츠는 자동 제외되어야 함
- FR-002-05: 이슈 선정 결과는 JSON 형식으로 저장되어야 함

**Acceptance Criteria:**

```
Given 20개 이상의 뉴스가 수집되었을 때
When 이슈 추출 모듈이 실행되면
Then 2~4개의 핵심 이슈가 선정되어야 함
And 각 이슈는 중요도 점수를 가져야 함
And 이슈는 중요도 순으로 정렬되어야 함
And 광고성 콘텐츠는 포함되지 않아야 함
```

**기술적 의존성:**

- OpenAI API (GPT-4 또는 GPT-3.5-turbo)
- 자연어 처리 라이브러리

---

### 5.3. FR-003: 팟캐스트 대본 생성 모듈

**우선순위:** P0 (필수)

**설명:** 선정된 이슈를 바탕으로 1분 분량의 팟캐스트 대본을 생성합니다.

**상세 요구사항:**

- FR-003-01: 대본은 60초 이내 읽기 분량이어야 함 (한국어 약 150-180자)
- FR-003-02: 대본은 다음 구조를 따라야 함
  1. Hook: 시청자 관심을 끄는 도입부 (1문장)
  2. Body: 2~4개 이슈 설명 (구조화된 설명)
  3. Closing: 마무리 멘트 (1문장)
- FR-003-03: 대본 톤은 다음 특성을 가져야 함
  - 전문적이면서도 친근한 팟캐스트 스타일
  - 경어체 사용
  - 설명형이고 이해하기 쉬운 표현
- FR-003-04: 날짜와 요일 정보를 대본에 포함해야 함
- FR-003-05: 생성된 대본은 텍스트 파일로 저장되어야 함

**Acceptance Criteria:**

```
Given 2~4개의 핵심 이슈가 선정되었을 때
When 대본 생성 모듈이 실행되면
Then 1분 분량의 완성된 대본이 생성되어야 함
And 대본은 Hook-Body-Closing 구조를 가져야 함
And 대본 톤은 팟캐스트 스타일이어야 함
And 모든 이슈가 대본에 포함되어야 함
And 대본은 저장되어야 함
```

**기술적 의존성:**

- OpenAI API
- 프롬프트 엔지니어링 템플릿

---

### 5.4. FR-004: HeyGen 영상 제작 모듈

**우선순위:** P0 (필수)

**설명:** 생성된 대본을 HeyGen API를 통해 영상으로 제작합니다.

**상세 요구사항:**

- FR-004-01: 고정된 캐릭터 ID를 사용해야 함
- FR-004-02: 고정된 배경/템플릿 ID를 사용해야 함
- FR-004-03: 영상 사양은 다음을 충족해야 함
  - 해상도: 1080x1920 (9:16 비율)
  - 길이: 60초 이하
  - 포맷: MP4
- FR-004-04: HeyGen API 호출 후 작업 ID를 받아야 함
- FR-004-05: 영상 생성 상태를 폴링으로 확인해야 함
  - 최대 대기 시간: 10분
  - 폴링 간격: 30초
- FR-004-06: 완성된 영상 URL 또는 파일을 다운로드해야 함
- FR-004-07: 실패 시 최대 2회 재시도해야 함

**Acceptance Criteria:**

```
Given 대본이 생성되었을 때
When HeyGen 영상 제작이 요청되면
Then HeyGen API가 작업 ID를 반환해야 함
And 시스템은 영상 완료를 폴링으로 확인해야 함
And 완성된 영상은 1080x1920 해상도여야 함
And 영상 길이는 60초 이하여야 함
And 고정 캐릭터와 배경이 사용되어야 함
```

**기술적 의존성:**

- HeyGen API
- 파일 다운로드 및 저장 시스템

---

### 5.5. FR-005: YouTube Shorts 업로드 모듈

**우선순위:** P0 (필수)

**설명:** 완성된 영상을 YouTube에 Shorts 형식으로 업로드합니다.

**상세 요구사항:**

- FR-005-01: YouTube Data API v3를 사용해야 함
- FR-005-02: OAuth 2.0 인증을 사용해야 함
- FR-005-03: 업로드 메타데이터는 다음을 포함해야 함
  - 제목: "오늘의 한국 경제 한 줄 브리핑 (YYYY-MM-DD) #shorts"
  - 설명: 주요 이슈 리스트 및 간단 설명
  - 태그: ["한국경제", "경제뉴스", "주식시장", "금리", "환율", "shorts"]
  - 카테고리: 뉴스 및 정치
- FR-005-04: 업로드 성공 시 영상 ID와 URL을 로그에 기록해야 함
- FR-005-05: OAuth 토큰 만료 시 자동으로 갱신해야 함
- FR-005-06: 업로드 실패 시 재시도 로직이 있어야 함

**Acceptance Criteria:**

```
Given 영상 파일이 준비되었을 때
When YouTube 업로드가 실행되면
Then 영상이 Shorts 형식으로 업로드되어야 함
And 제목에 날짜와 #shorts가 포함되어야 함
And 설명에 주요 이슈가 포함되어야 함
And 업로드 결과가 로그에 기록되어야 함
And OAuth 토큰이 자동으로 관리되어야 함
```

**기술적 의존성:**

- YouTube Data API v3
- OAuth 2.0 클라이언트
- googleapis npm 패키지

---

### 5.6. FR-006: 스케줄링 및 자동화 모듈

**우선순위:** P0 (필수)

**설명:** 매일 22:00에 전체 프로세스를 자동으로 실행합니다.

**상세 요구사항:**

- FR-006-01: node-cron 또는 유사 라이브러리를 사용해야 함
- FR-006-02: 크론 표현식은 "0 22 \* \* \*" (매일 22:00 KST)이어야 함
- FR-006-03: 서버 시작 시 스케줄러가 자동으로 등록되어야 함
- FR-006-04: 각 단계별 실행 상태를 추적해야 함
- FR-006-05: 전체 프로세스 실행 시간을 기록해야 함
- FR-006-06: 프로세스 중 에러 발생 시 다음 단계로 진행하지 않아야 함

**Acceptance Criteria:**

```
Given Express 서버가 실행 중일 때
When 22:00 KST가 되면
Then 자동으로 전체 프로세스가 시작되어야 함
And 각 단계가 순차적으로 실행되어야 함
And 모든 단계의 실행 상태가 기록되어야 함
And 에러 발생 시 프로세스가 중단되어야 함
```

**기술적 의존성:**

- node-cron
- 시간대 처리 라이브러리 (moment-timezone)

---

### 5.7. FR-007: 로깅 및 모니터링 모듈

**우선순위:** P1 (높음)

**설명:** 시스템의 모든 주요 작업과 에러를 기록합니다.

**상세 요구사항:**

- FR-007-01: 각 모듈의 시작/종료 시간을 기록해야 함
- FR-007-02: 에러 발생 시 상세 에러 정보를 기록해야 함
- FR-007-03: 로그 레벨을 구분해야 함 (INFO, WARN, ERROR)
- FR-007-04: 로그 파일은 날짜별로 분리되어야 함
- FR-007-05: 중요 에러 발생 시 알림을 전송해야 함 (Slack 또는 Email)
- FR-007-06: 성공적인 업로드의 경우 YouTube 링크를 기록해야 함

**Acceptance Criteria:**

```
Given 시스템이 작동 중일 때
When 각 모듈이 실행되면
Then 실행 시작/종료 로그가 기록되어야 함
And 에러 발생 시 상세 정보가 기록되어야 함
And 로그는 날짜별 파일에 저장되어야 함
And 중요 에러는 알림으로 전송되어야 함
```

**기술적 의존성:**

- winston 또는 pino (로깅 라이브러리)
- Slack Webhook 또는 Nodemailer

---

## 6. 기술 요구사항

### 6.1. 기술 스택

**백엔드:**

- Node.js 18.x 이상
- TypeScript 5.x
- Express.js 4.x

**주요 라이브러리:**

- node-cron: 스케줄링
- axios: HTTP 클라이언트
- cheerio: 웹 크롤링
- winston: 로깅
- dotenv: 환경 변수 관리
- googleapis: YouTube API 클라이언트

**외부 API:**

- OpenAI API (GPT-4 또는 GPT-3.5-turbo)
- HeyGen API
- YouTube Data API v3
- Google News RSS

### 6.2. TR-001: 개발 환경 설정

**요구사항:**

- TR-001-01: Node.js 18.x 이상이 설치되어야 함
- TR-001-02: TypeScript 개발 환경이 구성되어야 함
- TR-001-03: ESLint 및 Prettier가 설정되어야 함
- TR-001-04: Git 버전 관리가 설정되어야 함
- TR-001-05: 환경 변수 관리를 위한 .env 파일이 있어야 함

### 6.3. TR-002: API 키 관리

**요구사항:**

- TR-002-01: 모든 API 키는 환경 변수로 관리되어야 함
- TR-002-02: .env 파일은 .gitignore에 포함되어야 함
- TR-002-03: .env.example 파일로 필요한 키 목록을 문서화해야 함
- TR-002-04: API 키 유효성 검증 로직이 있어야 함

**필수 환경 변수:**

```
OPENAI_API_KEY=
HEYGEN_API_KEY=
HEYGEN_CHARACTER_ID=
HEYGEN_TEMPLATE_ID=
YOUTUBE_CLIENT_ID=
YOUTUBE_CLIENT_SECRET=
YOUTUBE_REFRESH_TOKEN=
SLACK_WEBHOOK_URL=
PORT=3000
NODE_ENV=production
```

### 6.4. TR-003: 데이터 저장

**요구사항:**

- TR-003-01: 뉴스 데이터는 임시 메모리 또는 로컬 JSON 파일에 저장
- TR-003-02: 생성된 대본은 텍스트 파일로 저장 (/data/scripts/)
- TR-003-03: 다운로드된 영상은 임시 저장 후 업로드 완료 시 삭제
- TR-003-04: 로그 파일은 /logs/ 디렉토리에 날짜별로 저장
- TR-003-05: 최근 30일 이전 로그는 자동 삭제 또는 아카이빙

### 6.5. TR-004: 에러 처리

**요구사항:**

- TR-004-01: 모든 외부 API 호출에 try-catch 블록이 있어야 함
- TR-004-02: 네트워크 에러 시 exponential backoff 재시도 로직
- TR-004-03: 타임아웃 설정: API 호출 최대 30초
- TR-004-04: 에러 발생 시 상세 컨텍스트 정보를 로그에 기록
- TR-004-05: 치명적 에러 발생 시 알림 전송

---

## 7. 시스템 아키텍처

### 7.1. 아키텍처 다이어그램

```
┌─────────────────────────────────────────────────────────────────┐
│                         Express Server                           │
│                                                                   │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │                   Scheduler (node-cron)                   │  │
│  │                    매일 22:00 KST 실행                    │  │
│  └──────────────────────────────────────────────────────────┘  │
│                              │                                    │
│                              ▼                                    │
│  ┌──────────────────────────────────────────────────────────┐  │
│  │              Daily Job Orchestrator                       │  │
│  │         (runKoreaDailyJob 메인 실행 함수)                │  │
│  └──────────────────────────────────────────────────────────┘  │
│                              │                                    │
│       ┌──────────────────────┼──────────────────────┐           │
│       ▼                      ▼                       ▼           │
│  ┌─────────┐          ┌──────────┐           ┌──────────┐      │
│  │  뉴스    │          │  이슈    │           │  대본    │      │
│  │  수집    │  ───►    │  추출    │  ───►     │  생성    │      │
│  │  모듈    │          │  모듈    │           │  모듈    │      │
│  └─────────┘          └──────────┘           └──────────┘      │
│       │                                             │            │
│       │                                             ▼            │
│       │                                      ┌──────────┐       │
│       │                                      │ HeyGen   │       │
│       │                                      │ 영상제작 │       │
│       │                                      │  모듈    │       │
│       │                                      └──────────┘       │
│       │                                             │            │
│       │                                             ▼            │
│       │                                      ┌──────────┐       │
│       │                                      │ YouTube  │       │
│       │                                      │ 업로드   │       │
│       │                                      │  모듈    │       │
│       │                                      └──────────┘       │
│       │                                             │            │
│       └─────────────────┬───────────────────────────┘           │
│                         ▼                                        │
│              ┌──────────────────┐                               │
│              │   로깅 & 모니터링  │                               │
│              │      모듈         │                               │
│              └──────────────────┘                               │
└─────────────────────────────────────────────────────────────────┘
                         │
          ┌──────────────┼──────────────┐
          ▼              ▼               ▼
    ┌─────────┐    ┌─────────┐    ┌─────────┐
    │  로그    │    │  영상    │    │  대본    │
    │  파일    │    │  파일    │    │  파일    │
    └─────────┘    └─────────┘    └─────────┘
```

### 7.2. 외부 서비스 연동

```
┌─────────────────────────────────────────────────────────────┐
│                      뉴스 소스                               │
├────────────────┬────────────────┬───────────────────────────┤
│  언론사 RSS    │  Google News   │  웹 크롤링                │
└────────────────┴────────────────┴───────────────────────────┘
         │                │                    │
         └────────────────┴────────────────────┘
                          │
                          ▼
         ┌────────────────────────────────┐
         │      Express Server            │
         │      (뉴스 수집 모듈)          │
         └────────────────────────────────┘
                          │
                          ▼
         ┌────────────────────────────────┐
         │        OpenAI API              │
         │   (이슈 추출 + 대본 생성)      │
         └────────────────────────────────┘
                          │
                          ▼
         ┌────────────────────────────────┐
         │        HeyGen API              │
         │       (영상 생성)              │
         └────────────────────────────────┘
                          │
                          ▼
         ┌────────────────────────────────┐
         │    YouTube Data API v3         │
         │       (영상 업로드)            │
         └────────────────────────────────┘
                          │
                          ▼
         ┌────────────────────────────────┐
         │     Slack Webhook              │
         │    (에러 알림 전송)            │
         └────────────────────────────────┘
```

### 7.3. 디렉토리 구조

```
economic-podcast/
├── src/
│   ├── app.ts                    # Express 앱 초기화
│   ├── server.ts                 # 서버 시작
│   ├── config/
│   │   ├── env.ts               # 환경 변수 설정
│   │   └── constants.ts         # 상수 정의
│   ├── scheduler/
│   │   └── dailyJob.ts          # 스케줄러 설정
│   ├── modules/
│   │   ├── newsCollector/
│   │   │   ├── index.ts
│   │   │   ├── rssCollector.ts
│   │   │   ├── googleNewsCollector.ts
│   │   │   └── types.ts
│   │   ├── issueExtractor/
│   │   │   ├── index.ts
│   │   │   ├── keywordAnalyzer.ts
│   │   │   ├── llmExtractor.ts
│   │   │   └── types.ts
│   │   ├── scriptGenerator/
│   │   │   ├── index.ts
│   │   │   ├── promptTemplates.ts
│   │   │   └── types.ts
│   │   ├── videoGenerator/
│   │   │   ├── index.ts
│   │   │   ├── heygenClient.ts
│   │   │   └── types.ts
│   │   ├── youtubeUploader/
│   │   │   ├── index.ts
│   │   │   ├── oauth.ts
│   │   │   ├── uploader.ts
│   │   │   └── types.ts
│   │   └── logger/
│   │       ├── index.ts
│   │       └── slackNotifier.ts
│   └── utils/
│       ├── dateTime.ts
│       ├── fileHandler.ts
│       └── retry.ts
├── data/
│   ├── scripts/                 # 생성된 대본 저장
│   └── temp/                    # 임시 영상 파일
├── logs/                        # 로그 파일
├── docs/
│   ├── prd.md                   # 본 문서
│   └── api-docs.md              # API 문서
├── tests/
│   ├── unit/
│   └── integration/
├── .env.example
├── .gitignore
├── package.json
├── tsconfig.json
└── README.md
```

---

## 8. 데이터 플로우

### 8.1. 상세 데이터 플로우

#### Step 1: 뉴스 수집

```
[22:00 스케줄 트리거]
         │
         ▼
[RSS 피드 요청] ──────► [RSS 파싱] ──────► [뉴스 객체 생성]
         │                                        │
[Google News 크롤링] ──► [HTML 파싱] ──────► [뉴스 객체 생성]
         │                                        │
[언론사 크롤링] ──────► [HTML 파싱] ──────► [뉴스 객체 생성]
         │                                        │
         └────────────────┬───────────────────────┘
                          ▼
                  [중복 제거 & 필터링]
                          │
                          ▼
                  [뉴스 배열 반환]
                 (Array<NewsItem>)
```

**데이터 구조:**

```typescript
interface NewsItem {
  title: string; // 뉴스 제목
  summary: string; // 요약/리드
  url: string; // 원문 링크
  publishedAt: Date; // 발행 시간
  source: string; // 언론사명
  category?: string; // 카테고리
}
```

#### Step 2: 이슈 추출

```
[뉴스 배열]
     │
     ▼
[키워드 빈도 분석] ──────► [키워드 맵 생성]
     │                          │
     │                          ▼
     │                  [상위 키워드 추출]
     │                          │
     ▼                          │
[OpenAI API 호출] ◄─────────────┘
     │
     │ (Prompt: 뉴스 요약 + 키워드 정보)
     │
     ▼
[GPT 응답 파싱]
     │
     ▼
[이슈 배열 반환]
(Array<Issue>)
```

**데이터 구조:**

```typescript
interface Issue {
  title: string; // 이슈 제목
  summary: string; // 이슈 요약 (2-3문장)
  importanceScore: number; // 중요도 점수 (1-100)
  keywords: string[]; // 관련 키워드
}
```

#### Step 3: 대본 생성

```
[이슈 배열] + [날짜 정보]
     │
     ▼
[프롬프트 템플릿 구성]
     │
     │ (시스템 프롬프트 + 이슈 데이터)
     │
     ▼
[OpenAI API 호출]
     │
     ▼
[대본 텍스트 파싱]
     │
     ▼
[길이 검증] (150-180자)
     │
     ▼
[대본 파일 저장]
     │
     ▼
[대본 문자열 반환]
```

**데이터 구조:**

```typescript
interface Script {
  text: string; // 전체 대본 텍스트
  wordCount: number; // 글자 수
  estimatedDuration: number; // 예상 소요 시간 (초)
  generatedAt: Date; // 생성 시간
  issues: Issue[]; // 포함된 이슈 목록
}
```

#### Step 4: 영상 생성

```
[대본 텍스트]
     │
     ▼
[HeyGen API 요청]
     │ (body: {
     │   script: string,
     │   characterId: string,
     │   templateId: string,
     │   resolution: "1080x1920"
     │ })
     │
     ▼
[작업 ID 수신]
     │
     ▼
[폴링 시작] (30초 간격)
     │
     ├──► [상태 확인 API 호출]
     │         │
     │         ├──► [진행 중] ──► [대기 30초] ──► [재확인]
     │         │
     │         └──► [완료] ──────────┐
     │                               │
     └───────────────────────────────┘
                     │
                     ▼
          [영상 URL 다운로드]
                     │
                     ▼
          [로컬 파일 저장]
                     │
                     ▼
          [파일 경로 반환]
```

**데이터 구조:**

```typescript
interface VideoJob {
  jobId: string; // HeyGen 작업 ID
  status: 'pending' | 'processing' | 'completed' | 'failed';
  videoUrl?: string; // 완성된 영상 URL
  localPath?: string; // 로컬 저장 경로
  createdAt: Date;
  completedAt?: Date;
}
```

#### Step 5: YouTube 업로드

```
[영상 파일 경로] + [메타데이터]
     │
     ▼
[OAuth 토큰 검증]
     │
     ├──► [만료됨] ──► [토큰 갱신]
     │                      │
     └──────────────────────┘
     │
     ▼
[YouTube API 업로드 요청]
     │ (multipart/form-data)
     │
     ▼
[업로드 진행 모니터링]
     │
     ▼
[업로드 완료 응답]
     │
     ▼
[영상 ID & URL 추출]
     │
     ▼
[로그 기록] + [Slack 알림]
     │
     ▼
[임시 파일 삭제]
```

**데이터 구조:**

```typescript
interface UploadResult {
  videoId: string; // YouTube 영상 ID
  videoUrl: string; // 영상 URL
  title: string; // 업로드된 제목
  uploadedAt: Date; // 업로드 시간
  status: 'success' | 'failed';
  error?: string; // 에러 메시지 (실패 시)
}
```

### 8.2. 전체 프로세스 타임라인

```
22:00:00  ─┐
           │  뉴스 수집 시작
22:00:05  ─┤  (평균 5초)
           │
22:00:05  ─┤  이슈 추출 시작
22:00:15  ─┤  (평균 10초, OpenAI API)
           │
22:00:15  ─┤  대본 생성 시작
22:00:25  ─┤  (평균 10초, OpenAI API)
           │
22:00:25  ─┤  HeyGen 영상 생성 요청
22:00:30  ─┤  (작업 ID 수신)
           │
22:00:30  ─┤  폴링 시작
  ...      │  (30초 간격)
22:08:00  ─┤  영상 완료 확인 (평균 7-8분)
22:08:30  ─┤  영상 다운로드 완료
           │
22:08:30  ─┤  YouTube 업로드 시작
22:10:00  ─┤  (평균 1-2분)
           │
22:10:00  ─┤  업로드 완료 & 로그 기록
           │
22:10:05  ─┘  전체 프로세스 종료
```

**예상 총 소요 시간:** 약 10-12분

---

## 9. 비기능 요구사항

### 9.1. 성능 요구사항

| 요구사항 ID | 설명                    | 목표      |
| ----------- | ----------------------- | --------- |
| NFR-PERF-01 | 뉴스 수집 응답 시간     | 5초 이내  |
| NFR-PERF-02 | 이슈 추출 응답 시간     | 15초 이내 |
| NFR-PERF-03 | 대본 생성 응답 시간     | 15초 이내 |
| NFR-PERF-04 | HeyGen 영상 생성 시간   | 10분 이내 |
| NFR-PERF-05 | YouTube 업로드 시간     | 3분 이내  |
| NFR-PERF-06 | 전체 프로세스 완료 시간 | 15분 이내 |

### 9.2. 가용성 요구사항

| 요구사항 ID  | 설명               | 목표               |
| ------------ | ------------------ | ------------------ |
| NFR-AVAIL-01 | 시스템 가동률      | 99% 이상 (월 기준) |
| NFR-AVAIL-02 | 일일 자동화 성공률 | 95% 이상           |
| NFR-AVAIL-03 | 외부 API 장애 대응 | 재시도 로직 포함   |

### 9.3. 확장성 요구사항

| 요구사항 ID | 설명                  | 목표                |
| ----------- | --------------------- | ------------------- |
| NFR-SCAL-01 | 다국가 지원 확장 가능 | 모듈화된 구조       |
| NFR-SCAL-02 | 뉴스 소스 추가 용이성 | 플러그인 방식       |
| NFR-SCAL-03 | 영상 형식 다양화      | 설정 기반 변경 가능 |

### 9.4. 보안 요구사항

| 요구사항 ID | 설명                | 목표                       |
| ----------- | ------------------- | -------------------------- |
| NFR-SEC-01  | API 키 관리         | 환경 변수로 관리, Git 제외 |
| NFR-SEC-02  | OAuth 토큰 보안     | 암호화 저장                |
| NFR-SEC-03  | 로그 민감 정보 보호 | API 키/토큰 마스킹         |

### 9.5. 유지보수성 요구사항

| 요구사항 ID | 설명          | 목표                       |
| ----------- | ------------- | -------------------------- |
| NFR-MAIN-01 | 코드 커버리지 | 70% 이상 (핵심 로직)       |
| NFR-MAIN-02 | 코드 문서화   | JSDoc 주석 필수            |
| NFR-MAIN-03 | 에러 추적     | 상세 로그 및 스택 트레이스 |

### 9.6. 모니터링 요구사항

| 요구사항 ID | 설명           | 목표                  |
| ----------- | -------------- | --------------------- |
| NFR-MON-01  | 실시간 알림    | 중요 에러 즉시 알림   |
| NFR-MON-02  | 로그 보관 기간 | 최소 30일             |
| NFR-MON-03  | 성공률 추적    | 주간/월간 리포트 가능 |

---

## 10. 제약사항 및 가정

### 10.1. 제약사항

#### 외부 API 제약

- **OpenAI API:** Rate limit 존재, 비용 발생
- **HeyGen API:** 영상 생성 시간 제어 불가 (평균 7-10분)
- **YouTube API:** 일일 업로드 쿼터 제한 (10,000 units/day)

#### 기술적 제약

- 고정 캐릭터/배경은 HeyGen에서 사전 설정 필요
- OAuth 토큰은 주기적 갱신 필요

#### 콘텐츠 제약

- 1분 제한으로 다룰 수 있는 이슈 개수 제한적 (2-4개)
- 뉴스 소스의 저작권 및 이용 약관 준수 필요
- YouTube 커뮤니티 가이드라인 준수 필요

### 10.2. 가정

#### 운영 가정

- Express 서버는 안정적인 네트워크 환경에서 실행
- 모든 외부 API 키는 유효하고 쿼터가 충분함
- 서버 시간대는 한국 표준시(KST)로 설정됨

#### 비즈니스 가정

- 한국 경제 뉴스는 매일 충분히 발생함 (최소 20건 이상)
- 대상 청중은 한국어 사용자
- 쇼츠 형식이 대상 청중에게 적합함

#### 기술적 가정

- HeyGen은 한국어 TTS를 지원함
- YouTube Shorts 알고리즘이 세로형 영상을 우대함
- OpenAI GPT는 한국 경제 뉴스를 이해하고 분석 가능함

---

## 11. 성공 지표

### 11.1. 시스템 성공 지표

| 지표                    | 목표      | 측정 방법                  |
| ----------------------- | --------- | -------------------------- |
| 자동화 성공률           | 95% 이상  | 월별 성공/실패 건수 비율   |
| 평균 프로세스 완료 시간 | 12분 이내 | 로그 기반 시간 측정        |
| 시스템 가동률           | 99% 이상  | 서버 다운타임 추적         |
| 에러 알림 응답률        | 100%      | 중요 에러 알림 전송 성공률 |

### 11.2. 콘텐츠 품질 지표

| 지표             | 목표     | 측정 방법               |
| ---------------- | -------- | ----------------------- |
| 이슈 관련성      | 80% 이상 | 수동 리뷰 (주간 샘플링) |
| 대본 톤 일관성   | 90% 이상 | 수동 리뷰 (주간 샘플링) |
| 영상 길이 준수율 | 100%     | 60초 이하 영상 비율     |

### 11.3. 비즈니스 지표

| 지표                  | 목표        | 측정 방법           |
| --------------------- | ----------- | ------------------- |
| 일일 업로드 연속 성공 | 28일 이상   | 연속 성공 일수 추적 |
| YouTube 조회수 증가율 | 월 10% 이상 | YouTube Analytics   |
| 구독자 증가율         | 월 5% 이상  | YouTube Analytics   |

---

## 12. 일정 및 마일스톤

### 12.1. 개발 단계

| 단계                             | 기간 | 주요 작업                                                           | 산출물                                      |
| -------------------------------- | ---- | ------------------------------------------------------------------- | ------------------------------------------- |
| **Phase 1: 설계 및 환경 구축**   | 1주  | - PRD 작성<br>- 기술 스택 선정<br>- 개발 환경 설정<br>- API 키 발급 | - PRD 문서<br>- 개발 환경<br>- .env.example |
| **Phase 2: 코어 모듈 개발**      | 2주  | - 뉴스 수집 모듈<br>- 이슈 추출 모듈<br>- 대본 생성 모듈            | - 3개 코어 모듈<br>- 단위 테스트            |
| **Phase 3: 영상 생성 및 업로드** | 2주  | - HeyGen 연동<br>- YouTube 업로드<br>- OAuth 구현                   | - 영상 생성 모듈<br>- 업로드 모듈           |
| **Phase 4: 자동화 및 모니터링**  | 1주  | - 스케줄러 구현<br>- 로깅 시스템<br>- 에러 알림                     | - 완전 자동화 시스템<br>- 모니터링 대시보드 |
| **Phase 5: 테스트 및 배포**      | 1주  | - 통합 테스트<br>- 실제 환경 테스트<br>- 배포                       | - 프로덕션 배포<br>- 운영 매뉴얼            |

**총 예상 기간:** 7주

### 12.2. 주요 마일스톤

| 마일스톤           | 예상 완료일 | 완료 기준                     |
| ------------------ | ----------- | ----------------------------- |
| M1: 개발 환경 완료 | Week 1      | 모든 API 키 설정 완료         |
| M2: 뉴스 수집 완료 | Week 2      | 20개 이상 뉴스 수집 성공      |
| M3: AI 분석 완료   | Week 3      | 이슈 추출 + 대본 생성 성공    |
| M4: 영상 생성 완료 | Week 5      | HeyGen 영상 1개 생성 성공     |
| M5: 첫 자동 업로드 | Week 6      | YouTube 쇼츠 자동 업로드 성공 |
| M6: 7일 연속 성공  | Week 7      | 7일 연속 자동화 성공          |

---

## 13. 향후 확장 계획

### 13.1. Phase 2 기능

#### 13.1.1. 미국 경제 뉴스 버전

- 미국 경제 뉴스 소스 추가
- 영어 대본 생성
- 별도 YouTube 채널 또는 플레이리스트 관리
- 미국 시장 시간에 맞춘 스케줄링

#### 13.1.2. 다중 언어 지원

- 영어, 일본어, 중국어 번역
- 각 언어별 TTS 및 캐릭터
- 다중 채널 관리

#### 13.1.3. 콘텐츠 A/B 테스트

- 다양한 대본 톤 실험
- 캐릭터/배경 조합 테스트
- 업로드 시간 최적화
- 썸네일 자동 생성 및 테스트

### 13.2. Phase 3 기능

#### 13.2.1. 인터랙티브 기능

- 사용자 댓글 분석
- 요청 이슈 우선 순위 반영
- 실시간 투표 시스템

#### 13.2.2. 플랫폼 확장

- Instagram Reels 업로드
- TikTok 업로드
- 네이버 블로그 자동 포스팅

#### 13.2.3. 분석 대시보드

- 실시간 조회수 모니터링
- 이슈별 인기도 분석
- 사용자 참여도 분석

### 13.3. 기술 부채 관리

- 데이터베이스 도입 (현재 파일 기반 → PostgreSQL/MongoDB)
- 마이크로서비스 아키텍처로 전환
- 컨테이너화 (Docker) 및 오케스트레이션 (Kubernetes)
- CI/CD 파이프라인 구축

---

## 14. 부록

### 14.1. API 명세 (간략)

#### 14.1.1. OpenAI API 사용 예시

**이슈 추출 프롬프트:**

```
당신은 한국 경제 전문 분석가입니다.
오늘 수집된 경제 뉴스를 분석하여 가장 중요한 2-4개 이슈를 추출해주세요.

뉴스 데이터:
[뉴스 제목 및 요약 목록]

다음 JSON 형식으로 응답해주세요:
[
  {
    "title": "이슈 제목",
    "summary": "2-3문장 요약",
    "importanceScore": 85,
    "keywords": ["키워드1", "키워드2"]
  }
]
```

**대본 생성 프롬프트:**

```
당신은 경제 팟캐스트 진행자입니다.
오늘 날짜: {날짜}
주요 이슈:
{이슈 목록}

1분 분량의 팟캐스트 대본을 작성해주세요.
구조:
1. Hook (1문장)
2. 이슈 설명 (2-4개 이슈)
3. 마무리 멘트 (1문장)

말투: 전문적이면서도 친근한 경어체
```

#### 14.1.2. HeyGen API 호출 예시

```typescript
// POST https://api.heygen.com/v1/video/generate
{
  "script": "대본 텍스트...",
  "character_id": "고정_캐릭터_ID",
  "template_id": "고정_템플릿_ID",
  "resolution": "1080x1920",
  "aspect_ratio": "9:16"
}

// Response
{
  "job_id": "abc123",
  "status": "pending"
}
```

#### 14.1.3. YouTube Data API 업로드 예시

```typescript
// POST https://www.googleapis.com/upload/youtube/v3/videos
// Headers: Authorization: Bearer {access_token}
// Body: multipart/form-data

{
  snippet: {
    title: "오늘의 한국 경제 한 줄 브리핑 (2025-12-17) #shorts",
    description: "주요 이슈:\n1. 금리 동결\n2. 환율 급등...",
    tags: ["한국경제", "경제뉴스", "shorts"],
    categoryId: "25" // 뉴스 및 정치
  },
  status: {
    privacyStatus: "public"
  }
}
```

### 14.2. 에러 코드 정의

| 코드            | 설명                           | 복구 방법                |
| --------------- | ------------------------------ | ------------------------ |
| ERR_NEWS_001    | 뉴스 수집 실패                 | 재시도 3회               |
| ERR_NEWS_002    | 수집된 뉴스 부족 (20개 미만)   | 소스 추가 또는 알림      |
| ERR_LLM_001     | OpenAI API 호출 실패           | 재시도 3회               |
| ERR_LLM_002     | 응답 파싱 실패                 | 프롬프트 수정 필요       |
| ERR_HEYGEN_001  | 영상 생성 요청 실패            | 재시도 2회               |
| ERR_HEYGEN_002  | 영상 생성 타임아웃 (15분 초과) | 알림 전송                |
| ERR_YOUTUBE_001 | OAuth 토큰 만료                | 자동 갱신 시도           |
| ERR_YOUTUBE_002 | 업로드 실패                    | 재시도 2회               |
| ERR_YOUTUBE_003 | 쿼터 초과                      | 알림 전송, 다음날 재시도 |

### 14.3. 로그 형식

```
[2025-12-17 22:00:00] [INFO] Daily job started
[2025-12-17 22:00:05] [INFO] News collection completed: 25 articles
[2025-12-17 22:00:15] [INFO] Issue extraction completed: 3 issues
[2025-12-17 22:00:25] [INFO] Script generation completed: 165 chars
[2025-12-17 22:00:30] [INFO] HeyGen job submitted: job_abc123
[2025-12-17 22:08:00] [INFO] Video generation completed: video.mp4
[2025-12-17 22:10:00] [INFO] YouTube upload completed: https://youtube.com/shorts/xyz789
[2025-12-17 22:10:05] [INFO] Daily job completed successfully in 10m 5s
```

### 14.4. 참고 자료

#### 공식 문서

- [OpenAI API Documentation](https://platform.openai.com/docs)
- [HeyGen API Documentation](https://docs.heygen.com)
- [YouTube Data API v3](https://developers.google.com/youtube/v3)
- [node-cron Documentation](https://www.npmjs.com/package/node-cron)

#### 관련 기술

- [Express.js Guide](https://expressjs.com/en/guide/routing.html)
- [TypeScript Handbook](https://www.typescriptlang.org/docs/)
- [OAuth 2.0 Specification](https://oauth.net/2/)

### 14.5. 용어집

| 용어  | 영문                              | 설명                               |
| ----- | --------------------------------- | ---------------------------------- |
| 쇼츠  | Shorts                            | YouTube의 세로형 짧은 동영상 형식  |
| 폴링  | Polling                           | 주기적으로 상태를 확인하는 방식    |
| 크론  | Cron                              | 시간 기반 작업 스케줄러            |
| OAuth | OAuth                             | 인증을 위한 개방형 표준 프로토콜   |
| TTS   | Text-to-Speech                    | 텍스트 음성 변환                   |
| API   | Application Programming Interface | 애플리케이션 프로그래밍 인터페이스 |
| LLM   | Large Language Model              | 대규모 언어 모델                   |
| RSS   | Really Simple Syndication         | 뉴스 및 블로그 피드 형식           |

---

## 문서 변경 이력

| 버전  | 날짜       | 작성자       | 변경 내용                            |
| ----- | ---------- | ------------ | ------------------------------------ |
| 1.0.0 | 2025-12-17 | Product Team | 초안 작성                            |
| 1.0.1 | 2025-12-17 | Product Team | 목차 번호 수정 및 불필요한 내용 삭제 |
